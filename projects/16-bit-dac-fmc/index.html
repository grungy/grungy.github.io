<!DOCTYPE html>
<html>

<head>
    <meta charset="utf-8">
    <title>Josh Marks&#39; Blog!</title>
    
    <meta name="description" content="Around - Multipurpose Bootstrap Template">
    <meta name="keywords" content="bootstrap, business, consulting, coworking space, services, creative agency, dashboard, e-commerce, mobile app showcase, multipurpose, product landing, shop, software, ui kit, web studio, landing, html5, css3, javascript, gallery, slider, touch, creative">
    <meta name="author" content="Createx Studio">
    
    <meta name="viewport" content="width=device-width, initial-scale=1">
    
    <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
    <link rel="manifest" href="site.webmanifest">
    <link rel="mask-icon" color="#5bbad5" href="safari-pinned-tab.svg">
    <meta name="msapplication-TileColor" content="#766df4">
    <meta name="theme-color" content="#ffffff">
    
    <style>
      .page-loading {
        position: fixed;
        top: 0;
        right: 0;
        bottom: 0;
        left: 0;
        width: 100%;
        height: 100%;
        -webkit-transition: all .4s .2s ease-in-out;
        transition: all .4s .2s ease-in-out;
        background-color: #fff;
        opacity: 0;
        visibility: hidden;
        z-index: 9999;
      }
      .page-loading.active {
        opacity: 1;
        visibility: visible;
      }
      .page-loading-inner {
        position: absolute;
        top: 50%;
        left: 0;
        width: 100%;
        text-align: center;
        -webkit-transform: translateY(-50%);
        transform: translateY(-50%);
        -webkit-transition: opacity .2s ease-in-out;
        transition: opacity .2s ease-in-out;
        opacity: 0;
      }
      .page-loading.active > .page-loading-inner {
        opacity: 1;
      }
      .page-loading-inner > span {
        display: block;
        font-family: 'Inter', sans-serif;
        font-size: 1rem;
        font-weight: normal;
        color: #737491;
      }
      .page-spinner {
        display: inline-block;
        width: 2.75rem;
        height: 2.75rem;
        margin-bottom: .75rem;
        vertical-align: text-bottom;
        border: .15em solid #766df4;
        border-right-color: transparent;
        border-radius: 50%;
        -webkit-animation: spinner .75s linear infinite;
        animation: spinner .75s linear infinite;
      }
      @-webkit-keyframes spinner {
        100% {
          -webkit-transform: rotate(360deg);
          transform: rotate(360deg);
        }
      }
      @keyframes spinner {
        100% {
          -webkit-transform: rotate(360deg);
          transform: rotate(360deg);
        }
      }
      
    </style>
    
    <script>
      (function () {
        window.onload = function () {
          var preloader = document.querySelector('.page-loading');
          preloader.classList.remove('active');
          setTimeout(function () {
            preloader.remove();
          }, 2000);
        };
      })();
      
    </script>
    
    <link rel="stylesheet" media="screen" href="/vendor/simplebar/dist/simplebar.min.css"/>
    <link rel="stylesheet" media="screen" href="/vendor/tiny-slider/dist/tiny-slider.css"/>
    <link rel="stylesheet" media="screen" href="/vendor/lightgallery.js/dist/css/lightgallery.min.css" />
    
    <link rel="stylesheet" media="screen" href="/css/theme.min.css">
  </head><body>
<div class="page-loading active">
  <div class="page-loading-inner">
    <div class="page-spinner"></div><span>Loading...</span>
  </div>
</div>
<main class="page-wrapper">
  
  <div class="modal fade" id="modal-contact" tabindex="-1">
    <div class="modal-dialog modal-dialog-centered">
      <div class="modal-content">
        <div class="modal-header mb-1">
          <h4 class="modal-title">What project are you looking for?</h4>
          <button class="btn-close" type="button" data-bs-dismiss="modal" aria-label="Close"></button>
        </div>
        <form class="modal-body needs-validation py-4" novalidate>
          <div class="btn-group mb-3">
            <div class="me-2 mb-2">
              <input class="btn-check" type="radio" name="services" id="illustration" autocomplete="off" checked>
              <label class="btn btn-outline-primary" for="illustration">Prototyping</label>
            </div>
            <div class="me-2 mb-2"> 
              <input class="btn-check" type="radio" name="services" id="packaging" autocomplete="off">
              <label class="btn btn-outline-primary" for="packaging">Firmware</label>
            </div>
            <div class="me-2 mb-2">
              <input class="btn-check" type="radio" name="services" id="branding" autocomplete="off">
              <label class="btn btn-outline-primary" for="branding">EMC</label>
            </div>
          </div>
          <div class="input-group mb-3"><i class="ai-user position-absolute top-50 start-0 translate-middle-y ms-3"></i>
            <input class="form-control rounded" type="text" placeholder="Name" required>
          </div>
          <div class="input-group mb-3"><i class="ai-mail position-absolute top-50 start-0 translate-middle-y ms-3"></i>
            <input class="form-control rounded" type="email" placeholder="Email" required>
          </div>
          <div class="mb-3 pb-1">
            <textarea class="form-control" rows="4" placeholder="Project description" required></textarea>
          </div>
          <div class="row py-2">
            <div class="col-lg-6 col-md-8">
              <button class="btn btn-primary d-block w-100" type="submit">Send Request</button>
            </div>
          </div>
        </form>
      </div>
    </div>
  </div>

      
      <header class="header navbar navbar-expand-lg navbar-light bg-light navbar-shadow navbar-sticky" data-scroll-header data-fixed-element>
        <div class="navbar-search bg-light">
            <div class="container d-flex flex-nowrap align-items-center"><i class="ai-search fs-xl"></i>
              <input class="form-control form-control-xl navbar-search-field" type="text" placeholder="Search site">
              <div class="d-flex align-items-center"><span class="text-muted fs-xs mt-1 d-none d-sm-inline">Close</span>
                <button class="btn-close p-2" type="button" data-bs-toggle="search"></button>
              </div>
            </div>
          </div>
          <div class="container px-0 px-xl-3">
            <button class="navbar-toggler ms-n2 me-2" type="button" data-bs-toggle="offcanvas" data-bs-target="#primaryMenu"><span class="navbar-toggler-icon"></span></button><a class="navbar-brand flex-shrink-0 order-lg-1 mx-auto ms-lg-0 pe-lg-2 me-lg-4" href="/index.html"><img class="d-none d-lg-block" src="/img/jam/logo-dark.png" alt="Around" width="100"><img class="d-lg-none" src="/img/jam/jam-logo.png" alt="Around" width="58"></a>
            <div class="d-flex align-items-center order-lg-3 ms-lg-auto"><a class="btn btn-primary d-lg-inline-block d-none" href="#modal-contact" data-bs-toggle="modal">Contact me</a><a class="btn btn-sm btn-primary d-lg-none d-inline-block" href="#modal-contact" data-bs-toggle="modal">Contact me</a></div>
            <div class="offcanvas offcanvas-collapse order-lg-2" id="primaryMenu">
              <div class="offcanvas-header navbar-shadow">
                <h5 class="mt-1 mb-0">Menu</h5>
                <button class="btn-close lead" type="button" data-bs-dismiss="offcanvas" aria-label="Close"></button>
              </div>
              <div class="offcanvas-body">
              
              <ul class="navbar-nav">
                
                <a class="nav-link" href="/posts/">
                    
                    Blog
                </a>
                
                <a class="nav-link" href="/projects/">
                    
                    Projects
                </a>
                
                <a class="nav-link" href="/books/">
                    
                    Books
                </a>
                
                <a class="nav-link" href="/about/">
                    
                    About Me
                </a>
                
              </ul>
            </div>
            
          
        </div>
      </header><div id="content">
<div class="container">
    
    
    <div class="row justify-content-center">
      
      <div class="col-lg-9 py-4 mb-2 mb-sm-0 pb-sm-5">
        <div class="pb-4" style="max-width: 38rem;">
            <nav aria-label="breadcrumb">
    <ol class="py-1 my-2 breadcrumb">
        <li class="breadcrumb-item"><a href="/">Home</a></li>
        
            
        
            
                <li class="breadcrumb-item"><a href="/projects">Projects</a></li>
            
        
            
                <li class="breadcrumb-item"><a href="/16-bit-dac-fmc">16 bit dac fmc</a></li>
            
        
            
        
    </ol>
</nav>
          <h1>16 Bit DAC FMC Card</h1>
        </div>
        


<time datetime="2021-07-25">Jul 25, 2021</time>
        
        <p class="py-3"><p>We required a higher resolution and faster Digital-toAnalog Converter (DAC) for our IRLED micro-display screen. The DAC in this program is responsible for setting the brightness of the IRLED pixel. A little overview diagram of the IRLED micro-display system would help understand the architecture. Below is a block diagram of the different components.</p>
<figure class="figure">
    <img src="/images/16-bit-dac-fmc/irled_micro_display_overview-1.png" class="figure-img" alt="..." style="max-width: 600px;">
    <figcaption class="figure-caption"></figcaption>
</figure>
<p>The information input for the system starts on the left of this diagram. Input video data comes in and is pre-distorted to account for individual pixel non-uniformity. We call this a Non-uniformity or NUC. The NUC’ed video is sent onto the Close Support Electronics (CSE). The CSE contains an FPGA that is responsible for converting the input video data format into the frame format used to draw imagery with CMOS ASIC. Out of the FPGA comes digital address signals and digital brightness values for each pixel. The job of the DAC board is to convert the 16 bit digital numbers from the FPGA into analog voltages. The analog voltages are then amplified using a several stage amplifier chain to the correct voltages for the ASIC.</p>
<p>Due to the high frame rates (400Hz to 1KHz), and high pixel resolution (512×512 to 2048×2048) required by the application of the IRLED micro-display the DAC must settle to the new value quickly. Commercially available high end DAC systems are typically setup for Radio Frequency (RF) applications because that is typically the use case for these devices. For our purposes we required time domain operation and preservation of DC information. This ultimately required an in-house design of a new DAC board. A picture of the end product of this in-house design effort is shown below.</p>
<figure class="figure">
    <img src="/images/16-bit-dac-fmc/dac_image.png" class="figure-img" alt="..." style="max-width: 600px;">
    <figcaption class="figure-caption"></figcaption>
</figure>
<p>We required a higher resolution and faster Digital-toAnalog Converter (DAC) for our IRLED micro-display screen. The DAC in this program is responsible for setting the brightness of the IRLED pixel. A little overview diagram of the IRLED micro-display system would help understand the architecture. Below is a block diagram of the different components.</p>
<p>irled_micro_display_overview</p>
<p>The information input for the system starts on the left of this diagram. Input video data comes in and is pre-distorted to account for individual pixel non-uniformity. We call this a Non-uniformity or NUC. The NUC’ed video is sent onto the Close Support Electronics (CSE). The CSE contains an FPGA that is responsible for converting the input video data format into the frame format used to draw imagery with CMOS ASIC. Out of the FPGA comes digital address signals and digital brightness values for each pixel. The job of the DAC board is to convert the 16 bit digital numbers from the FPGA into analog voltages. The analog voltages are then amplified using a several stage amplifier chain to the correct voltages for the ASIC.</p>
<p>Due to the high frame rates (400Hz to 1KHz), and high pixel resolution (512×512 to 2048×2048) required by the application of the IRLED micro-display the DAC must settle to the new value quickly. Commercially available high end DAC systems are typically setup for Radio Frequency (RF) applications because that is typically the use case for these devices. For our purposes we required time domain operation and preservation of DC information. This ultimately required an in-house design of a new DAC board. A picture of the end product of this in-house design effort is shown below.</p>
<p>DAC_image</p>
<p>At the top is a silkscreen rectangle that outlines the FMC connector. The FMC connector is used to attach this PCB to the FPGA board. FMC is convenient because it is a high density connector that maintains good signal integrity. Moving to the right is a sea of passive components that are supporting the two DACs on the other side of the card, terminating signal lines, and providing capacitance to power supplies.</p>
<p>The micro controller is the first IC visible on the board when moving from the FMC connector to the right. The micro controller is responsible for programming the DAC when testing the board without the FPGA, monitoring voltage levels of power supply lines, operating the feedback Analog to Digital Converter (ADC) for tuning in DAC parameters and setting LED light displays.</p>
<p>Moving to the right past the micro controller are the LED lights and the crystal for the micro controller. There are also two headers. One is a 100 mil pitch header and the other is a right angle header. The 100 mil pitch header is used to connect the DAC output to an amplifier card PCB, and the right angle header has several test signals routed to it for ease of troubleshooting.</p>
<h2 id="major-components">Major Components</h2>
<h3 id="digital-to-analog-converters">Digital to Analog Converters</h3>
<p>The DACs used in this project are the <a href="https://www.analog.com/media/en/technical-documentation/data-sheets/ad9743_9745_9746_9747.pdf">AD9747s</a> from Analog Devices. These DACs were chosen because they support 16 bits and fast enough sample rate (250 MSPS) for the application. A block diagram of the AD9747 is shown below. In each AD9747 part there are two DACs.</p>
<figure class="figure">
    <img src="/images/16-bit-dac-fmc/ad9747_block_diagram.png" class="figure-img" alt="..." style="max-width: 600px;">
    <figcaption class="figure-caption"></figcaption>
</figure>
<h2 id="microcontroller">Microcontroller</h2>
<p>The micro controller used in this project is a <a href="http://ww1.microchip.com/downloads/en/devicedoc/70592d.pdf">16 bit PIC24</a>. This micro controller was chosen because other in-house projects use this micro controller. This alleviated the need to maintain two tool chain and build environments for development work. If we were a larger organization I probably would have chosen a different micro controller. The PIC24HJ256GP210A- version of the micro controller was used in this project. The pinout for this micro controller is shown below.</p>
<figure class="figure">
    <img src="/images/16-bit-dac-fmc/pic24_pinout.png" class="figure-img" alt="..." style="max-width: 600px;">
    <figcaption class="figure-caption"></figcaption>
</figure>
<h2 id="schematic">Schematic</h2>
<h3 id="digital-to-analog-converter">Digital to Analog Converter</h3>
<p>The schematic for both DACs are shown below. The data signals from the FPGA come in from the left and are shown as a large bus that looks like the wires are shorted together. On the right are the two outputs from the DACs. The DACs have gain and offset adjustment secondary DACs to improve the performance of the main DACs. The resistor networks on the right are used to properly connect these adjustment DACs to the main DACs.</p>
<figure class="figure">
    <img src="/images/16-bit-dac-fmc/dac_schematic.png" class="figure-img" alt="..." style="max-width: 600px;">
    <figcaption class="figure-caption"></figcaption>
</figure>
<h2 id="micro-controller">Micro-Controller</h2>
<p>The schematic for the micro-controller is shown below. The micro-controller has an SPI connection to the FPGA in order to control the micro-controller and pass it new configuration parameters for the DACs. As well as any other required general communications. On the right the micro-controller is connected to the output LEDs for signaling board status and events.</p>
<figure class="figure">
    <img src="/images/16-bit-dac-fmc/dac_board_micro.png" class="figure-img" alt="..." style="max-width: 600px;">
    <figcaption class="figure-caption"></figcaption>
</figure>
</p>


        </div><footer class="footer pb-4 mt-sm-n5">
    <div class="container fs-sm text-center"><span class="text-muted">© 2021 All rights reserved. Made by Josh Marks</span></div>
</footer><a class="btn-scroll-top" href="#top" data-scroll data-fixed-element><span class="btn-scroll-top-tooltip text-muted fs-sm me-2">Top</span><i class="btn-scroll-top-icon ai-arrow-up">   </i></a>
    
    <script src="/vendor/bootstrap/dist/js/bootstrap.bundle.min.js"></script>
    <script src="/vendor/simplebar/dist/simplebar.min.js"></script>
    <script src="/vendor/smooth-scroll/dist/smooth-scroll.polyfills.min.js"></script>
    <script src="/vendor/tiny-slider/dist/min/tiny-slider.js"></script>
    <script src="/vendor/imagesloaded/imagesloaded.pkgd.min.js"></script>
    <script src="/vendor/shufflejs/dist/shuffle.min.js"></script>
    <script src="/vendor/parallax-js/dist/parallax.min.js"></script>
    <script src="/vendor/lightgallery.js/dist/js/lightgallery.min.js"></script>
    <script src="/vendor/lg-fullscreen.js/dist/lg-fullscreen.min.js"></script>
    <script src="/vendor/lg-zoom.js/dist/lg-zoom.min.js"></script>
    <script src="/vendor/lg-video.js/dist/lg-video.min.js"></script>
    <script type="text/javascript"
  src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script>
    
    <script src="/js/theme.min.js"></script></body>
</html>
